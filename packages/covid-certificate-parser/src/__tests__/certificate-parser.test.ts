import {CertificateParser} from '../certificate-parser';
import {forkJoin} from 'rxjs';

const qrPayloads = [
  'HC1:NCFS605G0/3WUWGSLKH47GO0KNJ9DSWQIIWT9CK4600XKY-CE59-G80:84F35RIV R2F3FMMTTBY50.FK6ZK7:EDOLOPCO8F6%E3.DA%EOPC1G72A6YM83G7NA7H:6JM8D%6I:61S8ZW6HL6C460S8VF6VX6UPC0JCZ69FVCPD0LVC6JD846Y96A466W5B56+EDG8F3I80/D6$CBECSUER:C2$NS346$C2%E9VC- CSUE145GB8JA5B$D% D3IA4W5646946%96X47.JCP9EJY8L/5M/5546.96D463KC.SC4KCD3DX47B46IL6646H*6Z/E5JD%96IA74R6646407GVC*JC1A6/Q63W5KF6746TPCBEC7ZKW.CU2DNXO VD5$C JC3/DMP8$ILZEDZ CW.C9WE.Y9AY8+S9VIAI3D8WEVM8:S9C+9$PC5$CUZCY$5Y$5FBBM00T%LTAT1MOQYR8GUN$K15LIGG2P27%A46BT52VUTL.1*B89Y5B428HRSR3I/E5DS/8NBY4H2BCN8NP1D4B:0K9UQQ67BLTH21AF0V8G52R 62+5BQYCV03SO79O6K+8UXL$T4$%RT150DUHZK+Q9TIE+IMQU4E/Q4T303TKWNXTSORE.4WNPCJX66NN-2F9IHTYLR6IR UAB98RR1A0P9DL0CS5KZ*HEGT1%TQWELFQHG5/JO9TI:.T1JQF.K7 EJ 2/CI5GASQP7ULRX4-07%9W2139E2HMGW99Q DQJADB3UAJKUCOVLG+9T+J:15.12U+OBMCJ1KZ+C+87I8I9JGA0T%U2CMFHI5U:L400C.CC/K3KJZ3OM/D59TBL5AZFMPIW4',
  'HC1:NCFK70DF0/3WUWGSLKH47GO0KNJ9DSWQIIWT9CK-600XKY-CE59-G80:84F36RIBJ42F3FMMPSKY50.FK6ZKZWEDOLOPCO8F6%E3.DA%EOPC1G72A6YM8JG70Y8I%6557F46G:6TG8ER6WW6F:6$A7+96/B8UPC0JCZ69+EDG8F3I80/D6$CBECSUER:C2$NS346$C2%E9VC- CSUE145GB8JA5B$D:TCQF6SG69/DY3FCEC%JC82E-M8*+A%R81A6M34U1D5UA QE3KC*PCT23846Y96B465W5HX6F462G7M%63R6Y$5F%68JB5WEQPD6$CSUEIN8G/D5$C4KCD3DX47B46IL6646H*6KWEKDDC%6-Q6QW66464KCCWE6T9OF6:/6NA76W5JPCT3E5JDJA76L68463W5/A6..DX%DZJC3/DH$9- NTVDWKEI3DK2D4XOXVD1/DLPCG/DU2D4ZA2T9GY8MPCG/DY-CAY81C9XY8O/EZKEZ96446256V50J.L3VJGEI7H9.VMVC7S+7E7LFEM2TILEVZN9FQDNMTDJCKXAYYV7+RKNPY:IC0FVR4/OGQ NY%B/Q44VC9NUYTUOSFSULKZ8H*S 3AKGQXC7ID2S4VA.B3L1C44G69+M6G4G$2E*H1BBD%-1-G6CAVGZ1%RI3VP59FUL1*O8/:PCRQL7PB9GP67ZRU-.KFE1AA33IP.HD%RM JNF:7DB48/4A.5-5C:GLXIGWM5Y2MU.GUMP*B25+D36H30EO1OJMM671M4U8WGN23OJ3+:6RW4VDPB 6P5CIW7O08U9J1B8KFP$Y7L0VLWCB4T-FJ3IDWTM/*HUV5H4L645NGF72G8C6BLC/+C:7B:N2:UT .LD5RA+GC36+PS YH 8WDLD18WM5T',
  'HC1:NCF060XG0/3WUWGSLKH47GO0KNJ9DSWQIIWT8CK DV/70YM8N34GB8FN0ZKCJ15WY03AC *UD97TK0F90GECQHGWJC0FDL:4:KEPH7M/ESDD746KG7+59/96GM8VW6/A8FM8/A8A46L*8/Q6RL60R6JM8WJCT3EYM8XJCS.CNF6OF63W59%6D46XJC/$ENF6OF64W5Y96RF6ZJC+KENF6OF63W5NW6VF6%JC+QE$.32%E6VCHQEU$DE44NXOBJE719$QE0/D+8D-ED.24-G8$:84KCD3DX47B46IL6646I*6GVC*JC1A6/Q63W5KF6746TPCBEC7ZKW.CU2DNXO VD5$C JC3/DMP8$ILZEDZ CW.C9WE.Y9AY8+S9VIAI3D8WEVM8:S9C+9$PC5$CUZCY$5Y$5FBB-205HKSUV$15H+9-IS1WQ1P3LP8O2ERWUC 1LR3E23EAGSFFPBE5 PKZI:-290EUR6:SAE0379W:R8:836/96Y3.FK0XC+2S57P*GJEZ2XATH.V %TZS1%VIHV940LOBWC6C9-6%Y6.RCHHV+2LP V:LP9K2-127-0DZECY00LC*/BRXCTS1GDTC7JX7OLREQ9GH32UT8.WSXD3UAMLKRGB9GRRN21N4VX:J9B88*3IJ0Q I5C5$0CL-MN.KJ69.9AF:L+AL5DAL0B9UTR6JWM6AR4PFJ5P7% COFMKZ7YM015MCY7QZ58 SORR$-4/K62LEU.BJ7HHC1/2GQDOWZPHKH+YK0GQV.895VFMNHYHXLPO09:Q7.AVMVICGN$OQ49VL1534',
  'HC1:NCFOXNYTSFDHJI8Y0PO%K7ING/0B71G.2AI6O:5QR9AV1OGIU-QOMOF9V0OUH5P/5OO$DK1JZZPQA36S4VT6SH9X5QFAIT567U10Q6JFEA0FV9EZ ERW6J.EA7N.Q6S*E746M$E$%6PK9/1AVU1+G9EPL.Q6846LEQ*FMNZ6R11:667C07ZD$J4VIJZEB9VCMCI7UJ$JC9VCYGIQZJX$KFP1W D7LE-+9DJA:CA4D93DAS/F0D9E2LBHHGKLO-K%FG5IAMEADII-GGUJKD70KDC40JIBG1KKQJKM+GHFEZI9$JAYHI5GKT*OB-S-*O5W41FDZ*G9W0OA7EGJYLVS469JA8/BB3CR.D7DAOKEH-B5IK:BGV6I68L*6OUYH:ZJ83BQ8T*EU%S26NJF0JEYI1DLNCKM52YHP/REG J YT3GSU+F80VLZ6X:39 7OKK:GEHUFO3NNE9EZ0 *C+WLGBJ17W9KU-/LSG7TGD%7K1WQX2Q1 4YT0SGEJHEMGBL+I.XNG*JKDTVTRPXTZ0SLXK*1K* VPOV4FN11S$K1QZTZ$5NBQ3MV3O6+VQSRER4GPFO:E9N2R94F 6Q3S3A/UZFUR*7C:MJZBXE4*WN0Y2I-TORT$54LQ5-:OJK7VUHA$Q1*31SCHMN+ALU0V33OU52IL2JW1O-TYMDHNOW+7*O6Q9N/:UJ B8:V*WQZKQZ6NU1OMLQ2OSGF4GSVWX8:$OG J13TS-BN03LDL4QA5D4YZQ 5QM1CJT9XY3RCLYTA23KF:931SCL2P.H6Q3WFJ T75ABQIQ3*OSER9NVKWG+ P/82JBVR20L*CR2',
  'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWPH9H9M9ESIARG4YK56C1FP8%V79FK$TF.HO$DK1JZZPQA3DP4OW631AX5QFAIT567U14Q69PM2Y69L6$T6W9EMWERF6Q MHS6.DETA6$%6PK9I+08II-NI  CG8C5DL-9C.PD8IIWGABQSIFTZF30AF1Z8J2K8FFZ.CE%GN9EZCA .CM:C.LG7Y87DA:0E6NSYLV0C58G1TFHQ*K5B9-NT0 2$$0X4PCY0X:CZD5CC9T0HM%2CNNE+4F/87LPMIH-O92UQMTU+W3*C0V$BUQ2RZ3$XJ0WBBPIAYUU-NK$FBX3XZQ5I9ZLIQ9AM.S-YN6DLUDBQEAJJKHHGWC87TGVKSH.4L-J X8P$H:2V8/E:N0Y%5EJS*72W/PLEWV5LR7O*4LM06ZYJNIEF$T$6E:B2A+0Q8SO6O*+FQ/T7OQ.UBDM4*LBZ51M87V50434/FF',
  'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWPX9H9M9ESIARGHXK*+D$055B9TUDP0J-MPW$NLEEEJCY S2%KYZPF97.P8-6C2UODM8-K6NN9UNARK4I/2*I2WN8I/6S-2-N9:WO$*SVFKC K:YM8J4RK46YBBOA3O8C KUGAACQ*883DO4C5K11P4D%PDS1JGDBTTTYIJGDBQMIGZIY8MGOIM423DJTIJ/CJ5VA81K0ECM8CXVDC8C 1J5OI:N0XHQVE4L/5R3FMIA9.B-7A6/D1FA1MGNPTU.H8ZA9NTGB7-PV.4H8F5G.4$2TW-26ALW.IDS02$VU*0H R*2H5NV9Y4KCTSVCVLVUXN+47U*00GVA057*KB*KYQTHFT4S8$ZG:SU5JUZDFSM7HMPF8V0FWM2A:EDE$KXYK/RRD1G79L7$OWLGY-QUGLESDN0UZCCR657673OVW-M7AUV7UIXRQU1O RHBO%6SU F%40IR485',
  'HC1:NCFOXN%TSMAHN-H/ZSR5J3ZJ0L6QMV-AH$P21ROT$S-+PA R .8QPTISTJO579GF*LH54CV4*XUA2P9FH4%HNTI4L6F$SFP1OPG$S9DQ5GS9WVHQ$9W.J5Z9J$HDQ5NXH+V9K-JAW1:PICIGLS4UP2859Y73JC3DG3IFT9A3M33IKBN33Y73B7DSCGN$KMQS63A0%K7TCTV6V11/Y43OR5JL1W4YLVRB4VIO5B9-NT0 2$$0X4PCY0+-C1W4/GJI+C7*4M:K0542V4X$75-C5-C:NNHJP7NVDEBK3JI:CB*05QNS*2IGF5JNBPIHVU9:VR*FRLG.UINXU2U37VBYVFU*BNSGXZQOJ97US9NT4W4TE2/HLIJL8JF8JF-62Y/I1PHW3FN*PORTW5KDLQWVV+F9TX5ZXBQD1QVJP*JYKFG3IWURJSC4%GORKZ 603BV BKZDVCS$/9Z:QY1P7JIKA3$LC75CIF097VCX9S1NS*N/:BWQRO4NU:3DFFFB6-0CVZHNQDE+A0MCTZBX 9GR9MAW0RH',
  'HC1:NCFOXN*TS0BI$ZDYSHFAUV/DZOG2TPO9245JW-4*YGJ59E2VE9E-RI%6BZ0TCV4*XUA2PWKP/HLIJL8JF8JF7LPMIH-O92UQ2I6/E2/IENXU1THXZQ4H9AMK*%FRZ3BT7.UI3$UN:HJI5P PL\u002B9P8Q\u002BC9FY1I%UL\u002B9AKPCPP0%MPU6QW6D9RX46UR5\u002BVB5VA81K0ECM8CXVDC8CS1JO.A  CG8C5DL*107FCJZI-.1RB8Z.CN*GS2C KEX1GDJI$ JW$PQ\u002BG3-QN*Q-M4UQIAQHRHAQRAQJAXO94SITTQ2G3Z%P6IA5B80K4T/5SWMAEK7755QLQQ5%YQ\u002BGOTH51\u002BPPHQ-RO*\u002BR$*O\u002B0QU*OL1R0HOK1R.GOGIRDNPMHPM*O10POEQG64KHGI.BO:VN:37WO91WU3A%PN5$VU5GK:1W5J7*NF3E FBNFFC0TX.8BH10VJ%-RNTMZ\u002BR.YV.$APX5ZHIF$Q.FAXO0CYP6Y33MCV4CKS0V:0DQF',
  'HC1:NCFT$9VIM\u002BJ2PS3MOUUD4-I3YAI7UOD35KDOA9OG:N-6VVRSX%17NEN6T9Q07FK.SF62NNXRV2T0SD3A8K617SGWS4-96NCDZBH9IEM02URT1NCD/0UX9:$O$52FU4C.901UF4OOXT0N2BIGP1T2A48$BV-1A5JKJFA9VOY039FEDWJ86JVTL99B$IT5F%\u002B3KXG.BHD9IOJAWHUEWC8NNKCDQR1$LGC.1NFBKP35LJYUKCVA4ELP$DQLRNEE7GNXRLU2W\u002B5OH$K0W86LVIHAF22-2DG%QD%8CY7-B0T8B3PN:Q60N8GU65NJ9AHB/LIMEGGM$2Q3GP:07HB7G/BRC06K0KG5D*QSZB.36QF8HU28BK2QLFKH4XT/X27CN7GWX%U.-2%XAMGQTY1$8BT3N2VBV5TK UI.THMRG5E-$2G07RNC82SVRC7BNM\u002BIEGQJ1V.C3D0T.15KFCL5G4I0B2BBEP.$5Y%4KN3XC6$PRLG8068MTK8C4H58/UK75T%/PZQ3.O3B\u002BPSVFBALSJBR*5*KAR3VIMPRPF 6K2:3X7J./523DG*8IQB/.2B2O1RVR/U8:V88P28GLCEX09-4WZGVI4KA*AOHF92OLNU8KV-71UR7W77S:FJXAQ/V\u002B7Q/ZNNYI',
  'HC1:NCFOX1SX7YUOO13.6AH:OHUKTGT022: 1P2OLLFQGAY*LV-M 4GJZAP52E$B$6VAPEX\u002BNQZBWR8D.2:*QCAA/$K.USX-A:8E6N0M29 SGAUGLBKHKT%4LI8ES5RWY00\u002BJPWMPFC7/7.4H8.K*0L6RMG.JQ.SD5N\u002B0RKFEZQT3IANN8.SQVHLV25EC6.-RKPJ62TEZ6P*TUWJXSTUAO-2JR5QBAT8FFYGSOZTR2PKT05CEEB6 IJGU7CN59VGQL0MCI\u002B941Y0903K/5FW7Y6BI00OS4V/IKI8UY0J00P7MP\u002B6JR2DEL*54PUTMWMJQV4 KJ10OH00ECYWUF92MDHJ/FK:V6B3%VH%WG1AW:XGR.J0YJCEBOBNFUPEL2TCO%.9A$EVP5FKM:TOBKSDK82$1I:Q:ID9BKFT0X*I4S91EQ%KL\u002B*MSM4-%6Z46BQ1D%6TI79VS-IT$1I.*GLKI0WVC498YVYTEZIAT6K49MX0DJ$FQ\u002BA531 277PSZ2EP6LHVRH19CCR1*FU:58UF:9K6N3U1KW\u002BQ16UNVE9IJ0*PVAWW4FP$G'
];

it('should parse all provided QR payloads', (done) => {
  forkJoin(qrPayloads.map(qrPayload => CertificateParser.ParseQrPayload(qrPayload)))
    .subscribe(certs => {
      for (const cert of certs) {
        expect(cert.qrPayloadVersion).toBe(1);
      }
      done();
    });
});

it('should parse correctly a QR payload', (done) => {
  const payload = 'HC1:NCFS605G0/3WUWGSLKH47GO0KNJ9DSWQIIWT9CK4600XKY-CE59-G80:84F35RIV R2F3FMMTTBY50.FK6ZK7:EDOLOPCO8F6%E3.DA%EOPC1G72A6YM83G7NA7H:6JM8D%6I:61S8ZW6HL6C460S8VF6VX6UPC0JCZ69FVCPD0LVC6JD846Y96A466W5B56+EDG8F3I80/D6$CBECSUER:C2$NS346$C2%E9VC- CSUE145GB8JA5B$D% D3IA4W5646946%96X47.JCP9EJY8L/5M/5546.96D463KC.SC4KCD3DX47B46IL6646H*6Z/E5JD%96IA74R6646407GVC*JC1A6/Q63W5KF6746TPCBEC7ZKW.CU2DNXO VD5$C JC3/DMP8$ILZEDZ CW.C9WE.Y9AY8+S9VIAI3D8WEVM8:S9C+9$PC5$CUZCY$5Y$5FBBM00T%LTAT1MOQYR8GUN$K15LIGG2P27%A46BT52VUTL.1*B89Y5B428HRSR3I/E5DS/8NBY4H2BCN8NP1D4B:0K9UQQ67BLTH21AF0V8G52R 62+5BQYCV03SO79O6K+8UXL$T4$%RT150DUHZK+Q9TIE+IMQU4E/Q4T303TKWNXTSORE.4WNPCJX66NN-2F9IHTYLR6IR UAB98RR1A0P9DL0CS5KZ*HEGT1%TQWELFQHG5/JO9TI:.T1JQF.K7 EJ 2/CI5GASQP7ULRX4-07%9W2139E2HMGW99Q DQJADB3UAJKUCOVLG+9T+J:15.12U+OBMCJ1KZ+C+87I8I9JGA0T%U2CMFHI5U:L400C.CC/K3KJZ3OM/D59TBL5AZFMPIW4';
  CertificateParser.ParseQrPayload(payload).subscribe((cert) => {
    expect(cert.certificate.nam.fnt).toBe('MUELLER');
    done();
  });
});

